2022-04-09 19:30:07.535742 """
You are given a string $s$ consisting of lowercase Latin letters "a", "b" and "c" and question marks "?".

Let the number of question marks in the string $s$ be $k$. Let's replace each question mark with one of the letters "a", "b" and "c". Here we can obtain all $3^{k}$ possible strings consisting only of letters "a", "b" and "c". For example, if $s = $"ac?b?c" then we can obtain the following strings: $[$"acabac", "acabbc", "acabcc", "acbbac", "acbbbc", "acbbcc", "accbac", "accbbc", "accbcc"$]$.

Your task is to count the total number of subsequences "abc" in all resulting strings. Since the answer can be very large, print it modulo $10^{9} + 7$.

A subsequence of the string $t$ is such a sequence that can be derived from the string $t$ after removing some (possibly, zero) number of letters without changing the order of remaining letters. For example, the string "baacbc" contains two subsequences "abc" — a subsequence consisting of letters at positions $(2, 5, 6)$ and a subsequence consisting of letters at positions $(3, 5, 6)$.


-----Input-----

The first line of the input contains one integer $n$ $(3 \le n \le 200\,000)$ — the length of $s$.

The second line of the input contains the string $s$ of length $n$ consisting of lowercase Latin letters "a", "b" and "c" and question marks"?".


-----Output-----

Print the total number of subsequences "abc" in all strings you can obtain if you replace all question marks with letters "a", "b" and "c", modulo $10^{9} + 7$.


-----Examples-----
Input
6
ac?b?c

Output
24

Input
7
???????

Output
2835

Input
9
cccbbbaaa

Output
0

Input
5
a???c

Output
46



-----Note-----

In the first example, we can obtain $9$ strings:  "acabac" — there are $2$ subsequences "abc",  "acabbc" — there are $4$ subsequences "abc",  "acabcc" — there are $4$ subsequences "abc",  "acbbac" — there are $2$ subsequences "abc",  "acbbbc" — there are $3$ subsequences "abc",  "acbbcc" — there are $4$ subsequences "abc",  "accbac" — there is $1$ subsequence "abc",  "accbbc" — there are $2$ subsequences "abc",  "accbcc" — there are $2$ subsequences "abc". 

So, there are $2 + 4 + 4 + 2 + 3 + 4 + 1 + 2 + 2 = 24$ subsequences "abc" in total.
"""
2022-04-09 19:30:07.535777 --------------------------
2022-04-09 19:30:26.047107 {
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "text": "\n\nimport sys\n\ndef main():\n    # read number of chars\n    n = int(sys.stdin.readline())\n    # read chars\n    s = sys.stdin.readline().strip()\n\n    # count number of a, b, c, ?\n    na = s.count('a')\n    nb = s.count('b')\n    nc = s.count('c')\n    nq = s.count('?')\n\n    # if there are no ? in s, check if there is a subsequence abc\n    if nq == 0:\n        if 'abc' in s:\n            print(1)\n        else:\n            print(0)\n        return\n\n    # if there are no a, b, c in s, count number of subsequences abc\n    if na == 0 and nb == 0 and nc == 0:\n        print(3 ** nq)\n        return\n\n    # prepare a list of possible positions of ?\n    qs = [i for i in range(n) if s[i] == '?']\n\n    # count number of subsequences abc\n    count = 0\n\n    for i in range(3 ** nq):\n        # replace ? with a, b, c\n        t = s\n        for j, q in enumerate(qs):\n            t = t[:q] + 'abc'[i // (3 ** (nq - j - 1)) % 3] + t[q + 1:]\n\n        # count number of subsequences abc\n        if 'abc' in t:\n            count += 1\n\n    # print result\n    print(count)\n\nif __name__ == '__main__':\n    main()"
    },
    {
      "finish_reason": "stop",
      "index": 1,
      "logprobs": null,
      "text": "\n\n#\ndef solve(n, s):\n    \"\"\"\n    >>> solve(6, 'ac?b?c')\n    24\n    >>> solve(7, '???????')\n    2835\n    >>> solve(9, 'cccbbbaaa')\n    0\n    >>> solve(5, 'a???c')\n    46\n    \"\"\"\n    mod = int(1e9 + 7)\n    # dp[i][j] : number of subsequences ending at index i with character j\n    dp = [[0] * 3 for _ in range(n + 1)]\n    dp[0][0] = 1\n    for i in range(1, n + 1):\n        for j in range(3):\n            if s[i - 1] == '?':\n                for k in range(3):\n                    dp[i][k] += dp[i - 1][j]\n            elif 'a' <= s[i - 1] <= 'c':\n                dp[i][ord(s[i - 1]) - ord('a')] += dp[i - 1][j]\n        for j in range(3):\n            dp[i][j] %= mod\n    return sum(dp[n]) % mod\n\n\nif __name__ == '__main__':\n    n = int(input())\n    s = input()\n    print(solve(n, s))"
    }
  ],
  "created": 1649547007,
  "id": "cmpl-4vEopWhXjnPB1vsxjG0hHM0FtKr5A",
  "model": "code-davinci:002",
  "object": "text_completion"
}
2022-04-09 19:30:26.047350 0 {
  "finish_reason": "stop",
  "index": 0,
  "logprobs": null,
  "text": "\n\nimport sys\n\ndef main():\n    # read number of chars\n    n = int(sys.stdin.readline())\n    # read chars\n    s = sys.stdin.readline().strip()\n\n    # count number of a, b, c, ?\n    na = s.count('a')\n    nb = s.count('b')\n    nc = s.count('c')\n    nq = s.count('?')\n\n    # if there are no ? in s, check if there is a subsequence abc\n    if nq == 0:\n        if 'abc' in s:\n            print(1)\n        else:\n            print(0)\n        return\n\n    # if there are no a, b, c in s, count number of subsequences abc\n    if na == 0 and nb == 0 and nc == 0:\n        print(3 ** nq)\n        return\n\n    # prepare a list of possible positions of ?\n    qs = [i for i in range(n) if s[i] == '?']\n\n    # count number of subsequences abc\n    count = 0\n\n    for i in range(3 ** nq):\n        # replace ? with a, b, c\n        t = s\n        for j, q in enumerate(qs):\n            t = t[:q] + 'abc'[i // (3 ** (nq - j - 1)) % 3] + t[q + 1:]\n\n        # count number of subsequences abc\n        if 'abc' in t:\n            count += 1\n\n    # print result\n    print(count)\n\nif __name__ == '__main__':\n    main()"
}
2022-04-09 19:30:26.047420 REASON stop
2022-04-09 19:30:26.059401 1 {
  "finish_reason": "stop",
  "index": 1,
  "logprobs": null,
  "text": "\n\n#\ndef solve(n, s):\n    \"\"\"\n    >>> solve(6, 'ac?b?c')\n    24\n    >>> solve(7, '???????')\n    2835\n    >>> solve(9, 'cccbbbaaa')\n    0\n    >>> solve(5, 'a???c')\n    46\n    \"\"\"\n    mod = int(1e9 + 7)\n    # dp[i][j] : number of subsequences ending at index i with character j\n    dp = [[0] * 3 for _ in range(n + 1)]\n    dp[0][0] = 1\n    for i in range(1, n + 1):\n        for j in range(3):\n            if s[i - 1] == '?':\n                for k in range(3):\n                    dp[i][k] += dp[i - 1][j]\n            elif 'a' <= s[i - 1] <= 'c':\n                dp[i][ord(s[i - 1]) - ord('a')] += dp[i - 1][j]\n        for j in range(3):\n            dp[i][j] %= mod\n    return sum(dp[n]) % mod\n\n\nif __name__ == '__main__':\n    n = int(input())\n    s = input()\n    print(solve(n, s))"
}
2022-04-09 19:30:26.059554 REASON stop

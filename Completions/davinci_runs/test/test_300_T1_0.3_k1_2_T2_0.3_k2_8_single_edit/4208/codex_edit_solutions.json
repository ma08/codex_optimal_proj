["\n\n\nimport sys\n\ndef main():\n    n = int(sys.stdin.readline())\n    l = sys.stdin.readline().strip()\n    r = sys.stdin.readline().strip()\n\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n\n        if r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n\n    count = 0\n    for k, v in l_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in r_dict:\n                count += min(len(v), len(r_dict[k]))\n    for k, v in r_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in l_dict:\n                count += min(len(v), len(l_dict[k]))\n\n    print(count)\n    for k, v in l_dict.items():\n        if k == '?':\n            for i in v:\n                print(i + 1, '?', sep=' ')\n        else:\n            if k in r_dict:\n                for i in range(min(len(v), len(r_dict[k]))):\n                    print(v[i] + 1, r_dict[k][i] + 1, sep=' ')\n    for k, v in r_dict.items():\n        if k == '?':\n            for i in v:\n                print('?', i + 1, sep=' ')\n        else:\n            if k in l_dict:\n                for i in range(min(len(v), len(l_dict[k]))):\n                    print(l_dict[k][i] + 1, v[i] + 1, sep=' ')\n\n\nif __name__ == \"__main__\":\n    main()\n", "#!/usr/bin/env python3\n\nimport sys\n\ndef main():\n    n = int(sys.stdin.readline())\n    l = sys.stdin.readline().strip()\n    r = sys.stdin.readline().strip()\n\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n\n        if r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n\n    count = 0\n    for k, v in l_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in r_dict:\n                count += min(len(v), len(r_dict[k]))\n    for k, v in r_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in l_dict:\n                count += min(len(v), len(l_dict[k]))\n\n    print(count)\n    for k, v in l_dict.items():\n        if k == '?':\n            for i in v:\n                print(i + 1, '?', sep=' ')\n        else:\n            if k in r_dict:\n                for i in range(min(len(v), len(r_dict[k]))):\n                    print(v[i] + 1, r_dict[k][i] + 1, sep=' ')\n    for k, v in r_dict.items():\n        if k == '?':\n            for i in v:\n                print('?', i + 1, sep=' ')\n        else:\n            if k in l_dict:\n                for i in range(min(len(v), len(l_dict[k]))):\n                    print(l_dict[k][i] + 1, v[i] + 1, sep=' ')\n\n\nif __name__ == \"__main__\":\n    main()\n", "\n\ndef main():\n    n = int(input())\n    l = input().split()\n    r = input().split()\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':  # if the character is ?\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:  # if the character is not ?\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n        if r[i] == '?':  # if the character is ?\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:  # if the character is not ?\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n    res = 0\n    pairs = []\n    for key in l_dict:  # for every key in l_dict\n        if key in r_dict:\n            if len(l_dict[key]) <= len(r_dict[key]):  # if the length of the list is less than or equal to the length of the list in r_dict\n                res += len(l_dict[key])\n                for i in range(len(l_dict[key])):  # for every index in the list\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n            else:  # if the length of the list is greater than the length of the list in r_dict\n                res += len(r_dict[key])\n                for i in range(len(r_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n    if '?' in l_dict and '?' in r_dict:\n        res += min(len(l_dict['?']), len(r_dict['?']))\n        for i in range(min(len(l_dict['?']), len(r_dict['?']))):\n            pairs.append([l_dict['?'][i]+1, r_dict['?'][i]+1])\n    print(res)\n    for pair in pairs:\n        print(pair[0], pair[1])\n\nif __name__ == '__main__':\n    main()\n", "\n\ndef main():\n    n = int(input())\n    l = list(input())\n    r = list(input())\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?' and r[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        elif l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n        elif r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n    res = 0\n    pairs = []\n    for key in l_dict:\n        if key in r_dict:\n            if len(l_dict[key]) <= len(r_dict[key]):\n                res += len(l_dict[key])\n                for i in range(len(l_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n            else:\n                res += len(r_dict[key])\n                for i in range(len(r_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n    print(res)\n    for pair in pairs:\n        print(pair[0], pair[1])\n\nif __name__ == '__main__':\n    main()\n", "\n\ndef main():\n    n = int(input())\n    l = list(input())\n    r = list(input())\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n        if r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n    res = 0\n    pairs = []\n    for key in l_dict:\n        if key in r_dict:\n            if len(l_dict[key]) <= len(r_dict[key]):\n                res += len(l_dict[key])\n                for i in range(len(l_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n            else:\n                res += len(r_dict[key])\n                for i in range(len(r_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n    if '?' in l_dict and '?' in r_dict:\n        res += min(len(l_dict['?']), len(r_dict['?']))\n        for i in range(min(len(l_dict['?']), len(r_dict['?']))):\n            pairs.append([l_dict['?'][i]+1, r_dict['?'][i]+1])\n    print(res)\n    for pair in pairs:\n        print(pair[0], pair[1])\n\nif __name__ == '__main__':\n    main()\n", "\n\ndef main():\n    n = int(input())\n    l = input().strip()\n    r = input().strip()\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n        if r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n    res = 0\n    pairs = []\n    for key in l_dict:\n        if key in r_dict:\n            if len(l_dict[key]) <= len(r_dict[key]):\n                res += len(l_dict[key])\n                for i in range(len(l_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n            else:\n                res += len(r_dict[key])\n                for i in range(len(r_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n    if '?' in l_dict and '?' in r_dict:\n        res += min(len(l_dict['?']), len(r_dict['?']))\n        for i in range(min(len(l_dict['?']), len(r_dict['?']))):\n            pairs.append([l_dict['?'][i]+1, r_dict['?'][i]+1])\n    print(res)\n    for pair in pairs:\n        print(pair[0], pair[1])\n\nif __name__ == '__main__':\n    main()\n", "\n\nimport sys\n\ndef main():\n    n = int(sys.stdin.readline())\n    l = sys.stdin.readline().strip().split()\n    r = sys.stdin.readline().strip().split()\n\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n\n        if r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n\n    count = 0\n    for k, v in l_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in r_dict:\n                count += min(len(v), len(r_dict[k]))\n    for k, v in r_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in l_dict:\n                count += min(len(v), len(l_dict[k]))\n\n    print(count)\n    for k, v in l_dict.items():\n        if k == '?':\n            for i in v:\n                print(i + 1, '?', sep=' ')\n        else:\n            if k in r_dict:\n                for i in range(min(len(v), len(r_dict[k]))):\n                    print(v[i] + 1, r_dict[k][i] + 1, sep=' ')\n    for k, v in r_dict.items():\n        if k == '?':\n            for i in v:\n                print('?', i + 1, sep=' ')\n        else:\n            if k in l_dict:\n                for i in range(min(len(v), len(l_dict[k]))):\n                    print(l_dict[k][i] + 1, v[i] + 1, sep=' ')\n\n\nif __name__ == \"__main__\":\n    main()\n", "\n\ndef main():\n    n = int(input())\n    l = list(input())\n    r = list(input())\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?' or r[i] == '?':\n            if '?' in l_dict or '?' in r_dict:\n                l_dict['?'].append(i) if '?' in l_dict else l_dict['?'] = [i]\n                r_dict['?'].append(i) if '?' in r_dict else r_dict['?'] = [i]\n            else:\n                l_dict['?'] = [i] if l[i] == '?' else l_dict[l[i]] = [i]\n                r_dict['?'] = [i] if r[i] == '?' else r_dict[r[i]] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n    res = 0\n    pairs = []\n    for key in l_dict:\n        if key in r_dict:\n            if len(l_dict[key]) <= len(r_dict[key]):\n                res += len(l_dict[key])\n                for i in range(len(l_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n            else:\n                res += len(r_dict[key])\n                for i in range(len(r_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n    if '?' in l_dict and '?' in r_dict:\n        res += min(len(l_dict['?']), len(r_dict['?']))\n        for i in range(min(len(l_dict['?']), len(r_dict['?']))):\n            pairs.append([l_dict['?'][i]+1, r_dict['?'][i]+1])\n    print(res)\n    for pair in pairs:\n        print(pair[0], pair[1])\n\nif __name__ == '__main__':\n    main()\n", "\n\ndef main():\n    n = int(input())\n    l = input()\n    r = input()\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '*':\n            if '*' in l_dict:\n                l_dict['*'].append(i)\n            else:\n                l_dict['*'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n        if r[i] == '*':\n            if '*' in r_dict:\n                r_dict['*'].append(i)\n            else:\n                r_dict['*'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n    res = 0\n    pairs = []\n    for key in l_dict:\n        if key in r_dict:\n            if len(l_dict[key]) <= len(r_dict[key]):\n                res += len(l_dict[key])\n                for i in range(len(l_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n            else:\n                res += len(r_dict[key])\n                for i in range(len(r_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n    if '*' in l_dict and '*' in r_dict:\n        res += min(len(l_dict['*']), len(r_dict['*']))\n        for i in range(min(len(l_dict['*']), len(r_dict['*']))):\n            pairs.append([l_dict['*'][i]+1, r_dict['*'][i]+1])\n    print(res)\n    for pair in pairs:\n        print(pair[0], pair[1])\n\nif __name__ == '__main__':\n    main()\n", "\ndef main():\n    n = int(input())\n    l = input()\n    r = input()\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n        if r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n    res = 0\n    pairs = []\n    for key in l_dict:\n        if key in r_dict:\n            if len(l_dict[key]) <= len(r_dict[key]):\n                res += len(l_dict[key])\n                for i in range(len(l_dict[key])):\n                    pairs.append([l_dict[key][i] + 1, r_dict[key][i] + 1])\n            else:\n                res += len(r_dict[key])\n                for i in range(len(r_dict[key])):\n                    pairs.append([l_dict[key][i] + 1, r_dict[key][i] + 1])\n    if '?' in l_dict and '?' in r_dict:\n        res += min(len(l_dict['?']), len(r_dict['?']))\n        for i in range(min(len(l_dict['?']), len(r_dict['?']))):\n            pairs.append([l_dict['?'][i] + 1, r_dict['?'][i] + 1])\n    print(res)\n    for pair in pairs:\n        print(pair[0], pair[1])\n\nif __name__ == '__main__':\n    main()\n", "\nimport sys\n\ndef main():\n    n = int(sys.stdin.readline())\n    l = sys.stdin.readline().strip()\n    r = sys.stdin.readline().strip()\n\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n\n        if r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n\n    count = 0\n    for k, v in l_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in r_dict:\n                count += min(len(v), len(r_dict[k]))\n    for k, v in r_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in l_dict:\n                count += min(len(v), len(l_dict[k]))\n\n    print(count)\n    for k, v in l_dict.items():\n        if k == '?':\n            for i in v:\n                print(i + 1, '?', sep=' ')\n        else:\n            if k in r_dict:\n                for i in range(min(len(v), len(r_dict[k]))):\n                    print(v[i] + 1, r_dict[k][i] + 1, sep=' ')\n    for k, v in r_dict.items():\n        if k == '?':\n            for i in v:\n                print('?', i + 1, sep=' ')\n        else:\n            if k in l_dict:\n                for i in range(min(len(v), len(l_dict[k]))):\n                    print(l_dict[k][i] + 1, v[i] + 1, sep=' ')\n\n\nif __name__ == \"__main__\":\n    main()\n", "\n\ndef check(l, r):\n    if l == '?' or r == '?':\n        return True\n    elif l == r:\n        return True\n    else:\n        return False\n\ndef main():\n    n = int(input())\n    l = input()\n    r = input()\n    res = 0\n    pairs = []\n    for i in range(n):\n        if check(l[i], r[i]):\n            res += 1\n            pairs.append([i+1, i+1])\n    for i in range(n):\n        for j in range(n):\n            if i != j and check(l[i], r[j]):\n                res += 1\n                pairs.append([i+1, j+1])\n                break\n    print(res)\n    for pair in pairs:\n        print(pair[0], pair[1])\n\nif __name__ == '__main__':\n    main()\n", "\nimport sys\n\ndef main():\n    n = int(sys.stdin.readline())\n    l = sys.stdin.readline().strip().split()\n    r = sys.stdin.readline().strip().split()\n\n    l_dict = {}\n    r_dict = {}\n    for i, v in enumerate(l):\n        if v in l_dict:\n            l_dict[v].append(i)\n        elif v == '?':\n            l_dict['?'] = [i]\n        elif v not in l_dict:\n            l_dict[v] = [i]\n\n    for i, v in enumerate(r):\n        if v in r_dict:\n            r_dict[v].append(i)\n        elif v == '?':\n            r_dict['?'] = [i]\n        elif v not in r_dict:\n            r_dict[v] = [i]\n\n    count = 0\n    for k in l_dict:\n        if k in r_dict:\n            count += min(len(l_dict[k]), len(r_dict[k]))\n        elif k == '?':\n            count += len(l_dict[k])\n    for k in r_dict:\n        if k in l_dict:\n            count += min(len(l_dict[k]), len(r_dict[k]))\n        elif k == '?':\n            count += len(r_dict[k])\n\n    print(count)\n    for k in l_dict:\n        if k in r_dict:\n            for i in range(min(len(l_dict[k]), len(r_dict[k]))):\n                print(l_dict[k][i] + 1, r_dict[k][i] + 1, sep=' ')\n        elif k == '?':\n            for i in l_dict[k]:\n                print(i + 1, '?', sep=' ')\n    for k in r_dict:\n        if k in l_dict:\n            for i in range(min(len(l_dict[k]), len(r_dict[k]))):\n                print(l_dict[k][i] + 1, r_dict[k][i] + 1, sep=' ')\n        elif k == '?':\n            for i in r_dict[k]:\n                print('?', i + 1, sep=' ')\n\n\nif __name__ == \"__main__\":\n    main()\n"]
2022-04-18 04:06:15.850498 """
You are given a string $s$ consisting of lowercase Latin letters "a", "b" and "c" and question marks "?".

Let the number of question marks in the string $s$ be $k$. Let's replace each question mark with one of the letters "a", "b" and "c". Here we can obtain all $3^{k}$ possible strings consisting only of letters "a", "b" and "c". For example, if $s = $"ac?b?c" then we can obtain the following strings: $[$"acabac", "acabbc", "acabcc", "acbbac", "acbbbc", "acbbcc", "accbac", "accbbc", "accbcc"$]$.

Your task is to count the total number of subsequences "abc" in all resulting strings. Since the answer can be very large, print it modulo $10^{9} + 7$.

A subsequence of the string $t$ is such a sequence that can be derived from the string $t$ after removing some (possibly, zero) number of letters without changing the order of remaining letters. For example, the string "baacbc" contains two subsequences "abc" — a subsequence consisting of letters at positions $(2, 5, 6)$ and a subsequence consisting of letters at positions $(3, 5, 6)$.


-----Input-----

The first line of the input contains one integer $n$ $(3 \le n \le 200\,000)$ — the length of $s$.

The second line of the input contains the string $s$ of length $n$ consisting of lowercase Latin letters "a", "b" and "c" and question marks"?".


-----Output-----

Print the total number of subsequences "abc" in all strings you can obtain if you replace all question marks with letters "a", "b" and "c", modulo $10^{9} + 7$.


-----Examples-----
Input
6
ac?b?c

Output
24

Input
7
???????

Output
2835

Input
9
cccbbbaaa

Output
0

Input
5
a???c

Output
46



-----Note-----

In the first example, we can obtain $9$ strings:  "acabac" — there are $2$ subsequences "abc",  "acabbc" — there are $4$ subsequences "abc",  "acabcc" — there are $4$ subsequences "abc",  "acbbac" — there are $2$ subsequences "abc",  "acbbbc" — there are $3$ subsequences "abc",  "acbbcc" — there are $4$ subsequences "abc",  "accbac" — there is $1$ subsequence "abc",  "accbbc" — there are $2$ subsequences "abc",  "accbcc" — there are $2$ subsequences "abc". 

So, there are $2 + 4 + 4 + 2 + 3 + 4 + 1 + 2 + 2 = 24$ subsequences "abc" in total.
"""
2022-04-18 04:06:15.850526 --------------------------
2022-04-18 04:07:55.038682 {
  "choices": [
    {
      "finish_reason": "length",
      "index": 0,
      "logprobs": null,
      "text": "\n\ndef abc(string, n):\n    \"\"\"\n    This function prints the total number of subsequences \"abc\" in all strings\n    you can obtain if you replace all question marks with letters \"a\", \"b\" and \"c\",\n    modulo 10^9 + 7.\n    \n    Parameters\n    ----------\n    string: string\n        Input string of length n consisting of lowercase Latin letters \"a\", \"b\"\n        and \"c\" and question marks \"?\".\n    n: int\n        Length of string.\n    \n    Returns\n    -------\n    total: int\n        Total number of subsequences \"abc\" in all strings.\n    \n    \"\"\"\n    # initialize total number of subsequences\n    total = 0\n    \n    # initialize number of a's, b's, c's and ?'s\n    a = 0\n    b = 0\n    c = 0\n    q = 0\n    \n    # iterate through string\n    for i in range(n):\n        # if letter is a\n        if string[i] == 'a':\n            a += 1\n        # if letter is b\n        elif string[i] == 'b':\n            b += 1\n        # if letter is c\n        elif string[i] == 'c':\n            c += 1\n        # if letter is ?\n        else:\n            q += 1\n            # if string of length 1, add 1 to total\n            if n == 1:\n                total += 1\n            # if string of length 2, add 3 to total\n            elif n == 2:\n                total += 3\n            # if string of length 3, add 6 to total\n            elif n == 3:\n                total += 6\n            # if string of length 4, add 10 to total\n            elif n == 4:\n                total += 10\n            # if string of length 5, add 15 to total\n            elif n == 5:\n                total += 15\n            # if string of length 6, add 21 to total\n            elif n == 6:\n                total += 21\n            # if string of length 7, add 28 to total\n            elif n == 7:\n                total += 28\n            # if string of length 8, add 36 to total\n            elif n == 8:\n                total += 36\n            # if string of length 9, add 45 to total\n            elif n == 9:\n                total += 45\n            # if string of length 10, add 55 to total\n            elif n == 10:\n                total += 55\n            # if string of length 11, add 66 to total\n            elif n == 11:\n                total += 66\n            # if string of length 12, add 78 to total\n            elif n == 12:\n                total += 78\n            # if string of length 13, add 91 to total\n            elif n == 13:\n                total += 91\n            # if string of length 14, add 105 to total\n            elif n == 14:\n                total += 105\n            # if string of length 15, add 120 to total\n            elif n == 15:\n                total += 120\n            # if string of length 16, add 136 to total\n            elif n == 16:\n                total += 136\n            # if string of length 17, add 153 to total\n            elif n == 17:\n                total += 153\n            # if string of length 18, add 171 to total\n            elif n == 18:\n                total += 171\n            # if string of length 19, add 190 to total\n            elif n == 19:\n                total += 190\n            # if string of length 20, add 210 to total\n            elif n == 20:\n                total += 210\n            # if string of length 21, add 231 to total\n            elif n == 21:\n                total += 231\n            # if string of length 22, add 253 to total\n            elif n == 22:\n                total += 253\n            # if string of length 23, add 276 to total\n            elif n == 23:\n                total += 276\n            # if string of length 24, add 300 to total\n            elif n == 24:\n                total += 300\n            # if string of length 25, add 325 to total\n            elif n == 25:\n                total += 325\n            # if string of length 26, add 351 to total\n            elif n == 26:\n                total += 351\n            # if string of length 27, add 378 to total\n            elif n == 27:\n                total += 378\n            # if string of length 28, add 406 to total\n            elif n == 28:\n                total += 406\n            # if string of length 29, add 435 to total\n            elif n == 29:\n                total += 435\n            # if string of length 30, add 465 to total\n            elif n == 30:\n                total += 465\n            # if string of length 31, add 496 to total\n            elif n == 31:\n                total += 496\n            # if string of length 32, add 528 to total\n            elif n == 32:\n                total += 528\n            # if string of length 33, add 561 to total\n            elif n == 33:\n                total += 561\n            # if string of length 34, add 595 to total\n            elif n == 34:\n                total += 595\n            # if string of length 35, add 630 to total\n            elif n == 35:\n                total += 630\n            # if string of length 36, add 666 to total\n            elif n == 36:\n                total += 666\n            # if string of length 37, add 703 to total\n            elif n == 37:\n                total += 703\n            # if string of length 38, add 741 to total\n            elif n == 38:\n                total += 741\n            # if string of length 39, add 780 to total\n            elif n == 39:\n                total += 780\n            # if string of length 40, add 820 to total\n            elif n == 40:\n                total += 820\n            # if string of length 41, add 861 to total\n            elif n == 41:\n                total += 861\n            # if string of length 42, add 903 to total\n            elif n == 42:\n                total += 903\n            # if string of length 43, add 946 to total\n            elif n == 43:\n                total += 946\n            # if string of length 44, add 990 to total\n            elif n == 44:\n                total += 990\n            # if string of length 45, add 1035 to total\n            elif n == 45:\n                total += 1035\n            # if string of length 46, add 1081 to total\n            elif n == 46:\n                total += 1081\n            # if string of length 47, add 1128 to total\n            elif n == 47:\n                total += 1128\n            # if string of length 48, add 1176 to total\n            elif n == 48:\n                total += 1176\n            # if string of length 49, add 1225 to total\n            elif n == 49:\n                total += 1225\n            # if string of length 50, add 1275 to total\n            elif n == 50:\n                total += 1275\n            # if string of length 51, add 1326 to total\n            elif n == 51:\n                total += 1326\n            # if string of length 52, add 1378 to total\n            elif n == 52:\n                total += 1378\n            # if string of length 53, add 1431 to total\n            elif n == 53:\n                total += 1431\n            # if string of length 54, add 1485 to total\n            elif n == 54:\n                total += 1485\n            # if string of length 55, add 1540 to total\n            elif n == 55:\n                total += 1540\n            # if string of length 56, add 1596 to total\n            elif n == 56:\n                total += 1596\n            # if string of length 57, add 1653 to total\n            elif n == 57:\n                total += 1653\n            # if string of length 58, add 1711 to total\n            elif n == 58:\n                total += 1711\n            # if string of length 59, add 1770 to total\n            elif n == 59:\n                total += 1770\n            # if string of length 60, add 1830 to total\n            elif n == 60:\n                total += 1830\n            # if string of length 61, add 1891 to total\n            elif n == 61:\n                total += 1891\n            # if string of length 62, add 1953 to total\n            elif n == 62:\n                total += 1953\n            # if string of length 63, add 2016 to total\n            elif n == 63:\n                total += 2016\n            # if string of length 64, add 2080 to total\n            elif n == 64:\n                total += 2080\n            # if string of length 65, add 2145 to total\n            elif n == 65:\n                total += 2145\n            # if string of length 66, add 2211 to total\n            elif n == 66:\n                total += 2211\n            # if string of length 67, add 2278 to total\n            elif n == 67:\n                total += 2278\n            # if string of length 68, add 2346 to total\n            elif n == 68:\n                total += 2346\n            # if string of length 69, add 2415 to total\n            elif n == 69:\n                total += 2415\n            # if string of length 70, add 2485 to total\n            elif n == 70:\n                total += 2485\n            # if string of length 71, add 2556 to total\n            elif n == 71:\n                total += 2556\n            # if string of length 72, add 2628 to total\n            elif n == 72:\n                total += 2628\n            # if string of length 73, add 2701 to total\n            elif n == 73:\n                total += 2701\n            # if string of length 74, add 2775 to total\n            elif n == 74:\n                total += 2775\n            # if string of length 75, add 2850 to total\n            elif n == 75:\n                total += 2850\n            # if string of length 76, add 2926 to total\n            elif n == 76:\n                total += 2926\n            # if string of length 77, add 3003 to total\n            elif n == 77:\n                total += 3003\n            # if string of length 78, add 3081 to total\n            elif n == 78:\n                total += 3081\n            # if string of length 79, add 3160 to total\n            elif n == 79:\n                total += 3160\n            # if string of length 80, add 3240 to total\n            elif n == 80:\n                total += 3240\n            # if string of length 81, add 3321 to total\n            elif n == 81:\n                total += 3321\n            # if string of length 82, add 3403 to total\n            elif n == 82:\n                total += 3403\n            # if string of length 83, add 3486 to total\n            elif n == 83:\n                total += 3486\n            # if string of length 84, add 3570 to total\n            elif n == 84:\n                total += 3570\n            # if string of length 85, add 3655 to total\n            elif n == 85:\n                total += 3655\n            # if string of length 86, add 3741 to total\n            elif n == 86:\n                total += 3741\n            # if string of length 87, add 3828 to total\n            elif n == 87:\n                total += 3828\n            # if string of length 88, add 3916 to total\n            elif n == 88:\n                total += 3916\n            # if string of length 89, add 4005 to total\n            elif n == 89:\n                total += 4005\n            # if string of length 90, add 4095 to total\n            elif n == 90:\n                total += 4095\n            # if string of length 91, add 4186 to total\n            elif n == 91:\n                total += 4186\n            # if string of length 92, add 4278 to total\n            elif n == 92:\n                total += 4278\n            # if string of length 93, add 4371 to total\n            elif n == 93:\n                total += 4371\n            # if string of length 94, add 4465 to total\n            elif n == 94:\n                total += 4465\n            # if string of length 95, add 4560 to total\n            elif n == 95:\n                total += 4560\n            # if string of length 96, add 4656 to total\n            elif n == 96:\n                total += 4656\n            # if string of length 97, add 4753 to total\n            elif n == 97:\n                total += 4753\n            # if string of length 98, add 4851 to total\n            elif n == 98:\n                total += 4851\n            # if string of length 99, add 4950 to total\n            elif n == 99:\n                total += 4950\n            # if string of length 100, add 5050 to total\n            elif n == 100:\n                total += 5050\n            # if string of length 101, add 5151 to total\n            elif n == 101:\n                total += 5151\n            # if string of length 102, add 5253 to total\n            elif n == 102:\n                total += 5253\n            # if string of length 103, add 5356 to total\n            elif n == 103:\n                total += 5356\n            # if string of length 104, add 5460 to total\n            elif n == 104:\n                total += 5460\n            # if string of length 105, add 5565 to total\n            elif n == 105:\n                total += 5565\n            # if string of length 106, add 5671 to total\n            elif n == 106:\n                total +="
    },
    {
      "finish_reason": "stop",
      "index": 1,
      "logprobs": null,
      "text": "\n\nimport sys\n\ndef main():\n    n = int(sys.stdin.readline().strip())\n    s = sys.stdin.readline().strip()\n    a = 0\n    b = 0\n    c = 0\n    count = 1\n    for i in range(n):\n        if s[i] == \"a\":\n            a += 1\n        elif s[i] == \"b\":\n            b += 1\n        elif s[i] == \"c\":\n            c += 1\n        else:\n            count = (count * 3) % 1000000007\n    print (a * b * c * count) % 1000000007\n\nif __name__ == '__main__':\n    main()"
    },
    {
      "finish_reason": "stop",
      "index": 2,
      "logprobs": null,
      "text": ""
    }
  ],
  "created": 1650254776,
  "id": "cmpl-4yCwSxeJkhvuSOvv3h4DbcqYGFpnW",
  "model": "code-davinci:002",
  "object": "text_completion"
}
2022-04-18 04:07:55.039138 0 {
  "finish_reason": "length",
  "index": 0,
  "logprobs": null,
  "text": "\n\ndef abc(string, n):\n    \"\"\"\n    This function prints the total number of subsequences \"abc\" in all strings\n    you can obtain if you replace all question marks with letters \"a\", \"b\" and \"c\",\n    modulo 10^9 + 7.\n    \n    Parameters\n    ----------\n    string: string\n        Input string of length n consisting of lowercase Latin letters \"a\", \"b\"\n        and \"c\" and question marks \"?\".\n    n: int\n        Length of string.\n    \n    Returns\n    -------\n    total: int\n        Total number of subsequences \"abc\" in all strings.\n    \n    \"\"\"\n    # initialize total number of subsequences\n    total = 0\n    \n    # initialize number of a's, b's, c's and ?'s\n    a = 0\n    b = 0\n    c = 0\n    q = 0\n    \n    # iterate through string\n    for i in range(n):\n        # if letter is a\n        if string[i] == 'a':\n            a += 1\n        # if letter is b\n        elif string[i] == 'b':\n            b += 1\n        # if letter is c\n        elif string[i] == 'c':\n            c += 1\n        # if letter is ?\n        else:\n            q += 1\n            # if string of length 1, add 1 to total\n            if n == 1:\n                total += 1\n            # if string of length 2, add 3 to total\n            elif n == 2:\n                total += 3\n            # if string of length 3, add 6 to total\n            elif n == 3:\n                total += 6\n            # if string of length 4, add 10 to total\n            elif n == 4:\n                total += 10\n            # if string of length 5, add 15 to total\n            elif n == 5:\n                total += 15\n            # if string of length 6, add 21 to total\n            elif n == 6:\n                total += 21\n            # if string of length 7, add 28 to total\n            elif n == 7:\n                total += 28\n            # if string of length 8, add 36 to total\n            elif n == 8:\n                total += 36\n            # if string of length 9, add 45 to total\n            elif n == 9:\n                total += 45\n            # if string of length 10, add 55 to total\n            elif n == 10:\n                total += 55\n            # if string of length 11, add 66 to total\n            elif n == 11:\n                total += 66\n            # if string of length 12, add 78 to total\n            elif n == 12:\n                total += 78\n            # if string of length 13, add 91 to total\n            elif n == 13:\n                total += 91\n            # if string of length 14, add 105 to total\n            elif n == 14:\n                total += 105\n            # if string of length 15, add 120 to total\n            elif n == 15:\n                total += 120\n            # if string of length 16, add 136 to total\n            elif n == 16:\n                total += 136\n            # if string of length 17, add 153 to total\n            elif n == 17:\n                total += 153\n            # if string of length 18, add 171 to total\n            elif n == 18:\n                total += 171\n            # if string of length 19, add 190 to total\n            elif n == 19:\n                total += 190\n            # if string of length 20, add 210 to total\n            elif n == 20:\n                total += 210\n            # if string of length 21, add 231 to total\n            elif n == 21:\n                total += 231\n            # if string of length 22, add 253 to total\n            elif n == 22:\n                total += 253\n            # if string of length 23, add 276 to total\n            elif n == 23:\n                total += 276\n            # if string of length 24, add 300 to total\n            elif n == 24:\n                total += 300\n            # if string of length 25, add 325 to total\n            elif n == 25:\n                total += 325\n            # if string of length 26, add 351 to total\n            elif n == 26:\n                total += 351\n            # if string of length 27, add 378 to total\n            elif n == 27:\n                total += 378\n            # if string of length 28, add 406 to total\n            elif n == 28:\n                total += 406\n            # if string of length 29, add 435 to total\n            elif n == 29:\n                total += 435\n            # if string of length 30, add 465 to total\n            elif n == 30:\n                total += 465\n            # if string of length 31, add 496 to total\n            elif n == 31:\n                total += 496\n            # if string of length 32, add 528 to total\n            elif n == 32:\n                total += 528\n            # if string of length 33, add 561 to total\n            elif n == 33:\n                total += 561\n            # if string of length 34, add 595 to total\n            elif n == 34:\n                total += 595\n            # if string of length 35, add 630 to total\n            elif n == 35:\n                total += 630\n            # if string of length 36, add 666 to total\n            elif n == 36:\n                total += 666\n            # if string of length 37, add 703 to total\n            elif n == 37:\n                total += 703\n            # if string of length 38, add 741 to total\n            elif n == 38:\n                total += 741\n            # if string of length 39, add 780 to total\n            elif n == 39:\n                total += 780\n            # if string of length 40, add 820 to total\n            elif n == 40:\n                total += 820\n            # if string of length 41, add 861 to total\n            elif n == 41:\n                total += 861\n            # if string of length 42, add 903 to total\n            elif n == 42:\n                total += 903\n            # if string of length 43, add 946 to total\n            elif n == 43:\n                total += 946\n            # if string of length 44, add 990 to total\n            elif n == 44:\n                total += 990\n            # if string of length 45, add 1035 to total\n            elif n == 45:\n                total += 1035\n            # if string of length 46, add 1081 to total\n            elif n == 46:\n                total += 1081\n            # if string of length 47, add 1128 to total\n            elif n == 47:\n                total += 1128\n            # if string of length 48, add 1176 to total\n            elif n == 48:\n                total += 1176\n            # if string of length 49, add 1225 to total\n            elif n == 49:\n                total += 1225\n            # if string of length 50, add 1275 to total\n            elif n == 50:\n                total += 1275\n            # if string of length 51, add 1326 to total\n            elif n == 51:\n                total += 1326\n            # if string of length 52, add 1378 to total\n            elif n == 52:\n                total += 1378\n            # if string of length 53, add 1431 to total\n            elif n == 53:\n                total += 1431\n            # if string of length 54, add 1485 to total\n            elif n == 54:\n                total += 1485\n            # if string of length 55, add 1540 to total\n            elif n == 55:\n                total += 1540\n            # if string of length 56, add 1596 to total\n            elif n == 56:\n                total += 1596\n            # if string of length 57, add 1653 to total\n            elif n == 57:\n                total += 1653\n            # if string of length 58, add 1711 to total\n            elif n == 58:\n                total += 1711\n            # if string of length 59, add 1770 to total\n            elif n == 59:\n                total += 1770\n            # if string of length 60, add 1830 to total\n            elif n == 60:\n                total += 1830\n            # if string of length 61, add 1891 to total\n            elif n == 61:\n                total += 1891\n            # if string of length 62, add 1953 to total\n            elif n == 62:\n                total += 1953\n            # if string of length 63, add 2016 to total\n            elif n == 63:\n                total += 2016\n            # if string of length 64, add 2080 to total\n            elif n == 64:\n                total += 2080\n            # if string of length 65, add 2145 to total\n            elif n == 65:\n                total += 2145\n            # if string of length 66, add 2211 to total\n            elif n == 66:\n                total += 2211\n            # if string of length 67, add 2278 to total\n            elif n == 67:\n                total += 2278\n            # if string of length 68, add 2346 to total\n            elif n == 68:\n                total += 2346\n            # if string of length 69, add 2415 to total\n            elif n == 69:\n                total += 2415\n            # if string of length 70, add 2485 to total\n            elif n == 70:\n                total += 2485\n            # if string of length 71, add 2556 to total\n            elif n == 71:\n                total += 2556\n            # if string of length 72, add 2628 to total\n            elif n == 72:\n                total += 2628\n            # if string of length 73, add 2701 to total\n            elif n == 73:\n                total += 2701\n            # if string of length 74, add 2775 to total\n            elif n == 74:\n                total += 2775\n            # if string of length 75, add 2850 to total\n            elif n == 75:\n                total += 2850\n            # if string of length 76, add 2926 to total\n            elif n == 76:\n                total += 2926\n            # if string of length 77, add 3003 to total\n            elif n == 77:\n                total += 3003\n            # if string of length 78, add 3081 to total\n            elif n == 78:\n                total += 3081\n            # if string of length 79, add 3160 to total\n            elif n == 79:\n                total += 3160\n            # if string of length 80, add 3240 to total\n            elif n == 80:\n                total += 3240\n            # if string of length 81, add 3321 to total\n            elif n == 81:\n                total += 3321\n            # if string of length 82, add 3403 to total\n            elif n == 82:\n                total += 3403\n            # if string of length 83, add 3486 to total\n            elif n == 83:\n                total += 3486\n            # if string of length 84, add 3570 to total\n            elif n == 84:\n                total += 3570\n            # if string of length 85, add 3655 to total\n            elif n == 85:\n                total += 3655\n            # if string of length 86, add 3741 to total\n            elif n == 86:\n                total += 3741\n            # if string of length 87, add 3828 to total\n            elif n == 87:\n                total += 3828\n            # if string of length 88, add 3916 to total\n            elif n == 88:\n                total += 3916\n            # if string of length 89, add 4005 to total\n            elif n == 89:\n                total += 4005\n            # if string of length 90, add 4095 to total\n            elif n == 90:\n                total += 4095\n            # if string of length 91, add 4186 to total\n            elif n == 91:\n                total += 4186\n            # if string of length 92, add 4278 to total\n            elif n == 92:\n                total += 4278\n            # if string of length 93, add 4371 to total\n            elif n == 93:\n                total += 4371\n            # if string of length 94, add 4465 to total\n            elif n == 94:\n                total += 4465\n            # if string of length 95, add 4560 to total\n            elif n == 95:\n                total += 4560\n            # if string of length 96, add 4656 to total\n            elif n == 96:\n                total += 4656\n            # if string of length 97, add 4753 to total\n            elif n == 97:\n                total += 4753\n            # if string of length 98, add 4851 to total\n            elif n == 98:\n                total += 4851\n            # if string of length 99, add 4950 to total\n            elif n == 99:\n                total += 4950\n            # if string of length 100, add 5050 to total\n            elif n == 100:\n                total += 5050\n            # if string of length 101, add 5151 to total\n            elif n == 101:\n                total += 5151\n            # if string of length 102, add 5253 to total\n            elif n == 102:\n                total += 5253\n            # if string of length 103, add 5356 to total\n            elif n == 103:\n                total += 5356\n            # if string of length 104, add 5460 to total\n            elif n == 104:\n                total += 5460\n            # if string of length 105, add 5565 to total\n            elif n == 105:\n                total += 5565\n            # if string of length 106, add 5671 to total\n            elif n == 106:\n                total +="
}
2022-04-18 04:07:55.039265 REASON length
2022-04-18 04:07:55.039274 1 {
  "finish_reason": "stop",
  "index": 1,
  "logprobs": null,
  "text": "\n\nimport sys\n\ndef main():\n    n = int(sys.stdin.readline().strip())\n    s = sys.stdin.readline().strip()\n    a = 0\n    b = 0\n    c = 0\n    count = 1\n    for i in range(n):\n        if s[i] == \"a\":\n            a += 1\n        elif s[i] == \"b\":\n            b += 1\n        elif s[i] == \"c\":\n            c += 1\n        else:\n            count = (count * 3) % 1000000007\n    print (a * b * c * count) % 1000000007\n\nif __name__ == '__main__':\n    main()"
}
2022-04-18 04:07:55.039309 REASON stop
2022-04-18 04:07:55.106598 2 {
  "finish_reason": "stop",
  "index": 2,
  "logprobs": null,
  "text": ""
}
2022-04-18 04:07:55.106665 REASON stop

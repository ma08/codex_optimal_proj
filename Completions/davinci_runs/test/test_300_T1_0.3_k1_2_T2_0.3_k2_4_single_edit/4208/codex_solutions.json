["\n\nimport sys\n\ndef main():\n    n = int(sys.stdin.readline())\n    l = sys.stdin.readline().strip()\n    r = sys.stdin.readline().strip()\n\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n\n        if r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n\n    count = 0\n    for k, v in l_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in r_dict:\n                count += min(len(v), len(r_dict[k]))\n    for k, v in r_dict.items():\n        if k == '?':\n            count += len(v)\n        else:\n            if k in l_dict:\n                count += min(len(v), len(l_dict[k]))\n\n    print(count)\n    for k, v in l_dict.items():\n        if k == '?':\n            for i in v:\n                print(i + 1, '?', sep=' ')\n        else:\n            if k in r_dict:\n                for i in range(min(len(v), len(r_dict[k]))):\n                    print(v[i] + 1, r_dict[k][i] + 1, sep=' ')\n    for k, v in r_dict.items():\n        if k == '?':\n            for i in v:\n                print('?', i + 1, sep=' ')\n        else:\n            if k in l_dict:\n                for i in range(min(len(v), len(l_dict[k]))):\n                    print(l_dict[k][i] + 1, v[i] + 1, sep=' ')\n\n\nif __name__ == \"__main__\":\n    main()", "\n\ndef main():\n    n = int(input())\n    l = input()\n    r = input()\n    l_dict = {}\n    r_dict = {}\n    for i in range(n):\n        if l[i] == '?':\n            if '?' in l_dict:\n                l_dict['?'].append(i)\n            else:\n                l_dict['?'] = [i]\n        else:\n            if l[i] in l_dict:\n                l_dict[l[i]].append(i)\n            else:\n                l_dict[l[i]] = [i]\n        if r[i] == '?':\n            if '?' in r_dict:\n                r_dict['?'].append(i)\n            else:\n                r_dict['?'] = [i]\n        else:\n            if r[i] in r_dict:\n                r_dict[r[i]].append(i)\n            else:\n                r_dict[r[i]] = [i]\n    res = 0\n    pairs = []\n    for key in l_dict:\n        if key in r_dict:\n            if len(l_dict[key]) <= len(r_dict[key]):\n                res += len(l_dict[key])\n                for i in range(len(l_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n            else:\n                res += len(r_dict[key])\n                for i in range(len(r_dict[key])):\n                    pairs.append([l_dict[key][i]+1, r_dict[key][i]+1])\n    if '?' in l_dict and '?' in r_dict:\n        res += min(len(l_dict['?']), len(r_dict['?']))\n        for i in range(min(len(l_dict['?']), len(r_dict['?']))):\n            pairs.append([l_dict['?'][i]+1, r_dict['?'][i]+1])\n    print(res)\n    for pair in pairs:\n        print(pair[0], pair[1])\n\nif __name__ == '__main__':\n    main()"]
["\ndef solve(n, s):\n    \"\"\"\n    >>> solve(6, 'ac?b?c')\n    24\n    >>> solve(7, '???????')\n    2835\n    >>> solve(9, 'cccbbbaaa')\n    0\n    >>> solve(5, 'a???c')\n    46\n    \"\"\"\n    mod = int(1e9 + 7)\n    # dp[i][j] : number of substrings ending at index i with character j\n    dp = [[0] * 3 for _ in range(n + 1)]\n    dp[0][0] = 1\n    for i in range(1, n + 1):\n        for j in range(3):\n            if s[i - 1] == '?':\n                for k in range(3):\n                    dp[i][k] += dp[i - 1][j]\n            elif 'a' <= s[i - 1] <= 'c':\n                dp[i][ord(s[i - 1]) - ord('a')] += dp[i - 1][j]\n        for j in range(3):\n            dp[i][j] %= mod\n    return sum(dp[n]) % mod\n\n\nif __name__ == '__main__':\n    n = int(input())\n    s = input()\n    print(solve(n, s))\n", "\n\n#\ndef solve(n, s):\n    \"\"\"\n    >>> solve(6, 'ac?b?c')\n    24\n    >>> solve(7, '???????')\n    2835\n    >>> solve(9, 'cccbbbaaa')\n    0\n    >>> solve(5, 'a???c')\n    46\n    \"\"\"\n    mod = int(1e9 + 7)\n    # dp[i][j] : number of subsequences ending at index i with character j\n    dp = [[0] * 3 for _ in range(n + 1)]\n    dp[0][0] = 1\n    for i in range(1, n + 1):\n        for j in range(3):\n            if s[i - 1] == '?':\n                for k in range(3):\n                    dp[i][k] += dp[i - 1][j]\n            elif 'a' <= s[i - 1] <= 'c':\n                dp[i][ord(s[i - 1]) - ord('a')] += dp[i - 1][j]\n        for j in range(3):\n            dp[i][j] %= mod\n    return sum(dp[n]) % mod\n\n\nif __name__ == '__main__':\n    n = int(input())\n    s = input()\n    print(solve(n, s))\n", "\n\ndef solve(n, s):\n    \"\"\"\n    >>> solve(6, 'ac?b?c')\n    24\n    >>> solve(7, '???????')\n    2835\n    >>> solve(9, 'cccbbbaaa')\n    0\n    >>> solve(5, 'a???c')\n    46\n    \"\"\"\n    mod = int(1e9 + 7)\n    # dp[i][j] : number of substrings ending at index i with character j\n    dp = [[0] * 3 for _ in range(n + 1)]\n    dp[0][0] = 1\n    for i in range(1, n + 1):\n        for j in range(3):\n            if s[i - 1] == '?':\n                for k in range(3):\n                    dp[i][k] += dp[i - 1][j]\n            elif 'a' <= s[i - 1] <= 'c':\n                dp[i][ord(s[i - 1]) - ord('a')] += dp[i - 1][j]\n        for j in range(3):\n            dp[i][j] %= mod\n    return sum(dp[n]) % mod\n\n\nif __name__ == '__main__':\n    n = int(input())\n    s = input()\n    print(solve(n, s))\n"]
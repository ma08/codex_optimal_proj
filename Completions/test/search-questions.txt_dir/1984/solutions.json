["def put():\n    return list(map(int, input().split()))\ndef diff(x,y):\n    ans = 0\n    for i in range(n*m):\n        if s[x][i]!= s[y][i]:\n            ans+=1\n    return ans\ndef find(i):\n    if i==p[i]:\n        return i\n    p[i] = find(p[i])\n    return p[i]\ndef union(i,j):\n    if rank[i]>rank[j]:\n        i,j = j,i\n    elif rank[i]==rank[j]:\n        rank[j]+=1\n    p[i]= j\ndef dfs(i,p):\n    if i!=0:\n        print(i,p)\n    for j in tree[i]:\n        if j!=p:\n            dfs(j,i)\n\nn,m,k,w = put()\ns = ['']*k \nfor i in range(k):\n    for j in range(n):\n        s[i]+=input()\nedge = []\nk+=1\nrank = [0]*(k)\np = list(range(k))\ncost = 0\ntree = [[] for i in range(k)]\n\nfor i in range(k):\n    for j in range(i+1,k):\n        if i==0:\n            z=n*m\n        else:\n            z = diff(i-1,j-1)*w\n        edge.append((z,i,j))\n\nedge.sort()\nfor z,i,j in edge:\n    u = find(i)\n    v = find(j)\n    if u!=v:\n        union(u,v)\n        cost+= z\n        tree[i].append(j)\n        tree[j].append(i)\n\nprint(cost)\ndfs(0,-1)\n"]
["def frequency(s,n):\n    f=[[0 for i in range(26)]for j in range(n+1)]\n    count=0\n    for i in range(n):\n        if s[i]!=\"#\":\n            f[count][ord(s[i])-97]+=1\n        else:\n            count+=1\n            for j in range(26):\n                f[count][j]=f[count-1][j]\n    return (f,count)\n    \ndef solve(s):\n    n=len(s)\n    f,count=frequency(s,n)\n    if count<3:\n        return 0\n    ans=0\n    index=[]\n    for i in range(n-1,-1,-1):\n        if s[i]==\"#\":\n            index.append(i)\n    \n    for c in range(1,count-2+1):\n        if index[-2]==index[-1]+1 or index[-3]==index[-2]+1:\n            index.pop()\n            continue\n        left=max(f[c-1])\n        mid1=0\n        mid2=0\n        right=0\n        for j in range(26):\n            mid1=max(mid1,f[c][j]-f[c-1][j])\n            mid2=max(mid2,f[c+1][j]-f[c][j])\n            right=max(right,f[count][j]-f[c+1][j])\n        if left and mid1 and mid2 and right:\n            ans=max(ans,left+mid1+mid2+right)\n        index.pop()\n    return ans\n    \nfor _ in range(int(input())):\n    s=input()\n    ans=solve(s)\n    if ans:\n        print(ans+3)\n    else:\n        print(0)\n        \n        "]
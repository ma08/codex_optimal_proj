["for _ in range(int(input())):\n n,x,m = map(int,input().split())\n a = list(map(int,input().split()))\n for _ in range(m):\n  for i in range(1,n):\n   a[i] = a[i] + a[i-1]\n print(a[x-1]%(10**9+7))", "def modInverse(a, m) : \n m0 = m \n y = 0\n x = 1\n\n if (m == 1) : \n  return 0\n\n while (a > 1) : \n  q = a // m \n\n  t = m \n  m = a % m \n  a = t \n  t = y \n  y = x - q * y \n  x = t \n if (x < 0) : \n  x = x + m0 \n\n return x\np=10**9+7\nf=[1]*(100000+1)\nfor i in range(1,100000+1):\n f[i]=i*f[i-1]\n if f[i]>p:\n  f[i]=f[i]%p\n\nfor _ in range(int(input())):\n n,x,m=map(int,input().split( ))\n m=m%p\n a=list(map(int,input().split( ))) \n pre=[1]*(x)\n for i in range(1,x):\n  pre[i]=pre[i-1]*((m+(i-1)))*f[i-1]\n  inv=modInverse(f[i],p)\n  pre[i]=(pre[i]*inv)%p\n ans=0\n j=0 \n for i in range(x-1,-1,-1):\n  ans+=a[j]*pre[i]\n  if ans>p:\n   ans=ans%p\n  j+=1\n print(ans%p)", "def modInverse(a, m) : \n m0 = m \n y = 0\n x = 1\n\n if (m == 1) : \n  return 0\n\n while (a > 1) : \n  q = a // m \n\n  t = m \n  m = a % m \n  a = t \n  t = y \n  y = x - q * y \n  x = t \n if (x < 0) : \n  x = x + m0 \n\n return x\np=10**9+7\nf=[1]*(100000+1)\nfor i in range(1,100000+1):\n f[i]=i*f[i-1]\n if f[i]>p:\n  f[i]=f[i]%p\n\nfor _ in range(int(input())):\n n,x,m=map(int,input().split( ))\n m=m%p\n a=list(map(int,input().split( ))) \n pre=[1]*(x)\n for i in range(1,x):\n  pre[i]=pre[i-1]*((m+(i-1)))*f[i-1]\n  inv=modInverse(f[i],p)\n  pre[i]=(pre[i]*inv)%p\n ans=0\n j=0 \n for i in range(x-1,-1,-1):\n  ans+=a[j]*pre[i]\n  if ans>p:\n   ans=ans%p\n  j+=1\n print(ans%p)", "p=10**9+7\nf=[1]*(100000+1)\nfor i in range(1,100000+1):\n f[i]=i*f[i-1]\n if f[i]>p:\n  f[i]=f[i]%p\n\nfor _ in range(int(input())):\n n,x,m=map(int,input().split( ))\n m=m%p\n a=list(map(int,input().split( ))) \n pre=[1]*(x)\n for i in range(1,x):\n  pre[i]=((((pre[i-1]%p)*((m+(i-1))%p))%p)%p*(f[i-1]%p))%p\n  pre[i]=pre[i]//f[i]\n ans=0\n j=0 \n for i in range(x-1,-1,-1):\n  ans+=a[j]*pre[i]\n  if ans>p:\n   ans=ans%p\n  j+=1\n print(ans%p)", "p=10**9+7\nf=[1]*(100000+1)\nfor i in range(1,100000+1):\n f[i]=i*f[i-1]\n if f[i]>p:\n  f[i]=f[i]%p\n\nfor _ in range(int(input())):\n n,x,m=map(int,input().split( ))\n m=m%p\n a=list(map(int,input().split( ))) \n pre=[1]*(x)\n for i in range(1,x):\n  pre[i]=pre[i-1]*(m+(i-1))*f[i-1]\n  if pre[i]>p:\n   pre[i]=pre[i]%p\n  pre[i]=pre[i]//f[i]\n ans=0\n j=0 \n for i in range(x-1,-1,-1):\n  ans+=a[j]*pre[i]\n  if ans>p:\n   ans=ans%p\n  j+=1\n print(ans%p)", "p=10**9+7\nf=[1]*(100000+1)\nfor i in range(1,100000+1):\n f[i]=i*f[i-1]\n if f[i]>=p:\n  f[i]=f[i]%p\n\nfor _ in range(int(input())):\n n,x,m=map(int,input().split( ))\n m=m%p\n a=list(map(int,input().split( ))) \n pre=[1]*(x)\n for i in range(1,x):\n  pre[i]=pre[i-1]*(m+(i-1))*f[i-1]\n  if pre[i]>=p:\n   pre[i]=pre[i]%p\n  pre[i]=pre[i]//f[i]\n ans=0\n j=0 \n for i in range(x-1,-1,-1):\n  ans+=a[j]*pre[i]\n  if ans>=p:\n   ans=ans%p\n  j+=1\n print(ans%p)", "p=10**9+7\nf=[1]*(100000+1)\nfor i in range(1,100000):\n f[i]=i*f[i-1]\n if f[i]>=p:\n  f[i]=f[i]%p\n\nfor _ in range(int(input())):\n n,x,m=map(int,input().split( ))\n m=m%p\n a=list(map(int,input().split( ))) \n pre=[1]*(x)\n for i in range(1,x):\n  pre[i]=pre[i-1]*(m+(i-1))*f[i-1]\n  if pre[i]>=p:\n   pre[i]=pre[i]%p\n  pre[i]=pre[i]//f[i]\n ans=0\n j=0 \n for i in range(x-1,-1,-1):\n  ans+=a[j]*pre[i]\n  if ans>=p:\n   ans=ans%p\n  j+=1\n print(ans%p)", "p=10**9+7\nf=[1]*(100000+1)\nfor i in range(1,100000):\n f[i]=i*f[i-1]\n if f[i]>=p:\n  f[i]=f[i]%p\n\nfor _ in range(int(input())):\n n,x,m=map(int,input().split( ))\n a=list(map(int,input().split( ))) \n pre=[1]*(x+1)\n for i in range(1,x):\n  pre[i]=pre[i-1]*(m+(i-1))*f[i-1]\n  if pre[i]>=p:\n   pre[i]=pre[i]%p\n  pre[i]=pre[i]//f[i]\n ans=0\n j=0 \n for i in range(x-1,-1,-1):\n  ans+=a[j]*pre[i]\n  if ans>=p:\n   ans=ans%p\n  j+=1\n print(ans)", "p=10**9+7\nf=[1]*(100+1)\nfor i in range(1,100):\n f[i]=i*f[i-1]\n if f[i]>=p:\n  f[i]=f[i]%p\n\nfor _ in range(int(input())):\n n,x,m=map(int,input().split( ))\n a=list(map(int,input().split( ))) \n pre=[1]*(x+1)\n for i in range(1,x):\n  pre[i]=pre[i-1]*(m+(i-1))*f[i-1]\n  if pre[i]>=p:\n   pre[i]=pre[i]%p\n  pre[i]=pre[i]//f[i]\n ans=0\n j=0 \n for i in range(x-1,-1,-1):\n  ans+=a[j]*pre[i]\n  if ans>=p:\n   ans=ans%p\n  j+=1\n print(ans)", "import math\nT=int(input())\nfor i in range(T):\n n,x,m=list(map(int,input().split()))\n l1=[int(i) for i in input().split()]\n if x==1:\n  l1[0]=l1[0]%1000000007\n  print(l1[0])\n elif x==2:\n  m=m%1000000007\n  l1[0]=l1[0]%1000000007\n  l1[1]=(l1[1]%1000000007+l1[0]*m%1000000007)%1000000007\n  print(l1[1])\n else:\n  m=m%1000000007\n  c=-1\n  y=0\n  q=1\n  f=1\n  y=(l1[x-1]%1000000007)\n  for j in range(x-2,-1,-1):\n   c=c+1\n   q=(q*((m+c)%1000000007))%1000000007\n   q=(q*pow(c+1,1000000005,1000000007))%1000000007\n   y=(y+(q*(l1[j]%1000000007))%1000000007)%1000000007\n   #print(q,s,c)\n   #print(y,s,l1[j])\n  print(y%1000000007)\n  \n\n", "T=int(input())\nfor i in range(T):\n n,x,m=list(map(int,input().split()))\n l1=[int(i) for i in input().split()]\n if x==1:\n  l1[0]=l1[0]%1000000007\n  print(l1[0])\n elif x==2:\n  m=m%1000000007\n  l1[0]=l1[0]%1000000007\n  l1[1]=(l1[1]%1000000007+l1[0]*m%1000000007)%1000000007\n  print(l1[1])\n else:\n  m=m%1000000007\n  c=-1\n  y=0\n  q=1\n  y=(l1[x-1]%1000000007)\n  for j in range(x-2,-1,-1):\n   c=c+1\n   q=(q*((m+c)%1000000007))%1000000007\n   #print(q)\n   s=(q*pow(c,1000000005,1000000007))%1000000007\n   y=(y+(s*(l1[j]%1000000007))%1000000007)%1000000007\n   #print(y,s,l1[j])\n  print(y)\n  \n\n", "T=int(input())\nfor i in range(T):\n n,x,m=list(map(int,input().split()))\n l1=[int(i) for i in input().split()]\n if x==1:\n  l1[0]=l1[0]%1000000007\n  print(l1[0])\n elif x==2:\n  m=m%1000000007\n  l1[0]=l1[0]%1000000007\n  l1[1]=(l1[1]%1000000007+l1[0]*m%1000000007)%1000000007\n  print(l1[1])\n else:\n  m=m%1000000007\n  c=-1\n  y=0\n  q=1\n  y=(l1[x-1]%1000000007)\n  for j in range(x-2,-1,-1):\n   c=c+1\n   q=(q*((m+c)%1000000007))%1000000007\n   print(q)\n   s=(q*pow(c,1000000005,1000000007))%1000000007\n   y=(y+(s*(l1[j]%1000000007))%1000000007)%1000000007\n   #print(y,s,l1[j])\n  print(y)\n  \n\n", "T=int(input())\nfor i in range(T):\n n,x,m=list(map(int,input().split()))\n l1=[int(i) for i in input().split()]\n if x==1:\n  l1[0]=l1[0]%1000000007\n  print(l1[0])\n elif x==2:\n  m=m%1000000007\n  l1[0]=l1[0]%1000000007\n  l1[1]=(l1[1]%1000000007+l1[0]*m%1000000007)%1000000007\n  print(l1[1])\n '''else:\n     m=m%1000000007\n     c=-1\n     y=0\n     q=1\n     y=(l1[x-1]%1000000007)\n     for j in range(x-2,-1,-1):\n      c=c+1\n      q=(q*((m+c)%1000000007))%1000000007\n      s=(q*pow(c,1000000005,1000000007))%1000000007\n      y=(y+(s*(l1[j]%1000000007))%1000000007)%1000000007\n      #print(y,s,l1[j])\n     print(y)'''\n  \n\n", "def mult(r,v):\n w=r\n for k in range(1,v):\n  w=(w*((k+r)%1000000007))%1000000007\n return w\nT=int(input())\nfor i in range(T):\n n,x,m=list(map(int,input().split()))\n l1=[int(i) for i in input().split()]\n if x==1:\n  l1[0]=l1[0]%1000000007\n  print(l1[0])\n elif x==2:\n  m=m%1000000007\n  l1[0]=l1[0]%1000000007\n  l1[1]=(l1[1]%1000000007+l1[0]*m%1000000007)%1000000007\n  print(l1[1])\n else:\n  m=m%1000000007\n  c=0\n  y=0\n  y=(l1[x-1]%1000000007)\n  for j in range(x-2,-1,-1):\n   c=c+1\n   s=(mult(m,c)*pow(c,1000000005,1000000007))%1000000007\n   y=(y+(s*(l1[j]%1000000007))%1000000007)%1000000007\n   #print(y,s,l1[j])\n  print(y)\n  \n\n", "T=int(input())\nfor i in range(T):\n n,x,m=list(map(int,input().split()))\n l1=[int(i) for i in input().split()]\n if x==1:\n  l1[0]=l1[0]%1000000007\n  print(l1[0])\n elif x==2:\n  m=m%1000000007\n  l1[0]=l1[0]%1000000007\n  l1[1]=(l1[1]%1000000007+l1[0]*m%1000000007)%1000000007\n  print(l1[1])\n", "T=int(input())\nfor k in range(T):\n n,x,m=list(map(int,input().split()))\n l1=[int(i) for i in input().split()]\n l2,l3=[],[]\n for i in range(len(l1)):\n  l2.append(0)\n  l3.append(0)\n l2[0]=l1[0]%1000000007\n for i in range(1,len(l1)):\n  l2[i]=((l1[i]%1000000007)+(l2[i-1]%1000000007))%1000000007\n if m==1:\n  print(l1[x-1]%1000000007)\n elif m==2:\n  print(l2[x-1])\n else:\n  l3[0]=l2[0]\n  l3[1]=(l1[1]+((m)*l1[0])%1000000007)%1000000007\n  #print(l3[1],x,l2[1])\n  s=0\n  v=0\n  for i in range(2,x):\n   s=l2[i-1]*(l2[i-1]-1)//2\n   # print(l2[i-1],s)\n   v=l3[i-1]*(l3[i-1]+1)//2\n   #print(l3[i-1],v)\n   #print(v-s)\n   l3[i]=((v-s)%1000000007+l1[i])%1000000007\n print(l3[x-1])\n  \n  \n \n", "T=int(input())\nfor k in range(T):\n n,x,m=list(map(int,input().split()))\n l1=[int(i) for i in input().split()]\n l2,l3=[],[]\n for i in range(len(l1)):\n  l2.append(0)\n  l3.append(0)\n l2[0]=l1[0]%1000000007\n for i in range(1,len(l1)):\n  l2[i]=((l1[i]%1000000007)+(l2[i-1]%1000000007))%1000000007\n if m==1:\n  print(l1[x-1]%1000000007)\n elif m==2:\n  print(l2[x-1])\n else:\n  l3[0]=l2[0]\n  l3[1]=(l1[1]+((m)*l1[0])%1000000007)%1000000007\n  #print(l3[1],x,l2[1])\n  s=0\n  v=0\n  for i in range(2,x):\n   s=l2[i-1]*(l2[i-1]-1)//2\n   # print(l2[i-1],s)\n   v=l3[i-1]*(l3[i-1]+1)//2\n   #print(l3[i-1],v)\n   #print(v-s)\n   l3[i]=((v-s)%1000000007+l1[i])%1000000007\n print(l3[x-1])\n  \n  \n \n", "T=int(input())\nfor k in range(T):\n n,x,m=list(map(int,input().split()))\n l1=[int(i) for i in input().split()]\n l2,l3=[],[]\n for i in range(len(l1)):\n  l2.append(0)\n  l3.append(0)\n l2[0]=l1[0]%1000000007\n for i in range(1,len(l1)):\n  l2[i]=((l2[i]%1000000007)+(l2[i-1]%1000000007))%1000000007\n if m==1:\n  print(l1[x-1]%1000000007)\n elif m==2:\n  print(l2[x-1])\n else:\n  l3[0]=l2[0]\n  l3[1]=(l1[1]+((m)*l1[0])%1000000007)%1000000007\n  s=0\n  v=0\n  for i in range(2,x):\n   s=l2[i-1]*(l2[i-1]-1)//2\n   v=l3[i-1]*(l3[i-1]+1)//2\n   l3[i]=(v-s)%1000000007\n print(l3[x-1])\n  \n  \n \n", "for _ in range(int(input())):\n n,x,m=list(map(int,input().split()))\n l=[int(i) for i in input().split()]\n MOD=10**9+7\n if x<=2:\n  if x==1:\n   print(l[0]%MOD)\n  else:\n   print((l[0]*m+l[1])%MOD)\n  continue \n\n temp=l[:]\n while m:\n  for i in range(1,n):\n   l[i]=l[i]+l[i-1]\n  #l=temp[:]\n  #print(l)\n  m-=1 \n print(l[x-1]%MOD)\n \n", "for _ in range(int(input())):\n n,x,m=list(map(int,input().split()))\n l=[int(i) for i in input().split()]\n MOD=10**9+7 \n temp=l[:]\n while m:\n  for i in range(1,n):\n   l[i]=l[i]+l[i-1]\n  #l=temp[:]\n  #print(l)\n  m-=1 \n print(l[x-1]%MOD)\n", "# cook your dish here\nfor _ in range(int(input())):\n n,x,m=list(map(int,input().split()))\n l=list(map(int,input().split()))\n q=[]\n for j in range(m):\n  for i in range(1,len(l)):\n   l[i]=l[i]+l[i-1]\n print(l[x-1]%(10**9 +7))\n", "'''input\n2\n3 2 3\n1 2 3\n3 3 3 \n1 2 3\n'''\nmod=10**9+7\nfor _ in range(int(input())):\n n,x,m=map(int,input().split())\n a=[int(i) for(i) in input().split()]\n ans=a[x-1]%mod\n f=1\n for i in range(1,x):\n  f=f*(m-1+i)\n  f=f//i\n  f=f%mod;\n  ans+=(a[x-1-i]*f)%mod\n print(ans%mod)", "'''input\n2\n3 2 3\n1 2 3\n3 3 3 \n1 2 3\n'''\nfor _ in range(int(input())):\n n,x,m=map(int,input().split())\n a=[int(i) for(i) in input().split()]\n ans=a[x-1]\n f=1\n for i in range(1,x):\n  f=f*(m-1+i)\n  f=f//i\n  ans+=a[x-1-i]*f\n print(ans%(10**9+7))"]
["", "\n\nimport fileinput\n\nn = int(input())\nfriends_list = [int(x) for x in input().split()]\n\nfor i in range(n):\n    if friends_list[i] == 0:\n        friends_list[i] = i + 1\n\nfor i in range(n):\n    if friends_list[i] == 0:\n        friends_list[i] = friends_list[i - 1] + 1\n\nfor i in range(n):\n    if friends_list[i] == i + 1:\n        friends_list[i] = friends_list[i - 1] + 1\n\nfor i in range(n):\n    if friends_list[i] == i + 1:\n        friends_list[i] = friends_list[i - 1] + 1\n\nprint(friends_list)", "\n\ndef solve(friends):\n    friends_dict = {}\n    for i, j in enumerate(friends):\n        if j == 0:\n            friends_dict[i+1] = []\n        else:\n            friends_dict[j].append(i+1)\n    res = list(friends)\n    while len(friends_dict) > 0:\n        key, val = friends_dict.popitem()\n        if len(val) == 0:\n            for k, v in friends_dict.items():\n                if len(v) == 0:\n                    continue\n                res[k-1] = key\n                val.append(k)\n                break\n        elif len(val) == 1:\n            res[val[0]-1] = key\n        else:\n            for v in val:\n                friends_dict[v].append(key)\n    return res\n\n\ndef main():\n    n = int(input())\n    friends = [int(x) for x in input().split()]\n    assert len(friends) == n\n    res = solve(friends)\n    print(\" \".join(str(x) for x in res))\n\n\nif __name__ == \"__main__\":\n    main()"]
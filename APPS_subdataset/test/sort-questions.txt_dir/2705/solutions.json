["t=1\nfor _ in range(t):\n    n,m,k=(list(map(int,input().split())))\n    a=list(map(int,input().split()))\n    for i in range(n):\n        a[i]=a[i]%k\n    \n    s=1\n    for j in range(k):\n        ss=0\n        v=0\n        for i in range(n):\n            v+=min(abs(a[i]-j),k-abs(a[i]-j))\n            while ss<i and v>m:\n                v-=min(abs(a[ss]-j),k-abs(a[ss]-j))\n                ss+=1\n            s=max(s,i-ss+1)\n        \n    print(s)\n"]